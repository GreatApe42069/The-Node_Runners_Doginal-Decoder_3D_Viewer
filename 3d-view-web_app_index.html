<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Node Runners Doginal Decoder</title>

    <!-- Link to Google Fonts stylesheet -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Madimi+One&display=swap">

    <style>
        @font-face {
            font-family: 'MadimiOne-Regular';
            src: url('./static/fonts/MadimiOne-Regular.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
            font-display: swap;
        }

        html,
        body {
            overflow: hidden;
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            position: relative; /* Added to position the logo relative to the body */
        }

        #bannerContainer {
            position: relative;
            width: 100%;
            height: 200px; /* Adjust the height as needed */
            cursor: pointer;
        }

        #bannerImage {
            width: 100%;
            height: 100%;
            object-fit: cover; /* Ensure the image covers the container */
        }

        #clickableText {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-family: 'MadimiOne-Regular', sans-serif;
            font-size: 24px;
            color: #fff; /* Adjust the color as needed */
            text-align: center;
            cursor: pointer;
            z-index: 2; /* Ensure the text is above the banner */
        }

        #ordinalsWalletButton {
            position: absolute;
            top: 10px; /* Adjust the top position as needed */
            left: 10px; /* Adjust the left position as needed */
            cursor: pointer;
            z-index: 2; /* Ensure the button is above the banner */
        }

        #ordinalsWalletButton img {
            width: 30px; /* Adjust the width as needed */
            height: auto; /* Maintain aspect ratio */
        }

        #renderCanvas {
            width: 100%;
            height: calc(100% - 200px); /* Adjust the height based on banner height */
            touch-action: none;
        }

        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 3;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgb(0, 0, 0);
            background-color: rgba(0, 0, 0, 0.9);
            padding-top: 60px;
        }

        .modal-content {
            margin: 5% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            background-color: #fefefe;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
    </style>
</head>

<body>
    <div id="bannerContainer">
        <img id="bannerImage" src="./static/Banner.jpg" alt="Banner Image" onclick="openModal()">
        <div id="clickableText">The Node Runners Doginal Decoder</div>
        <div id="ordinalsWalletButton" onclick="openModal()">
            <img src="./static/OrdinalsWalletLogo.png" alt="Ordinals Wallet Logo">
        </div>
    </div>

    <canvas id="renderCanvas"></canvas>

    <!-- Babylon.js scripts and loaders -->
    <script src="https://cdn.babylonjs.com/babylon.js"></script>
    <script src="https://cdn.babylonjs.com/loaders/babylonjs.loaders.min.js"></script>
    <script src="https://cdn.babylonjs.com/loaders/babylonjs.serializers.min.js"></script>
    <script src="https://cdn.babylonjs.com/loaders/babylonjs.materials.min.js"></script>

    <!-- 3MF loader script -->
    <script src="https://cdn.babylonjs.com/loaders/babylonjs.loaders.extension.3mf.min.js"></script>

    <script>
        // Your existing Babylon.js script goes here
        const canvas = document.getElementById("renderCanvas");
        const engine = new BABYLON.Engine(canvas, true);
        let currentModel;
        let scene;

        const createScene = function () {
            try {
                scene = new BABYLON.Scene(engine);

                // Camera setup
                const camera = new BABYLON.ArcRotateCamera("camera", 1.5, 1.5, 14, BABYLON.Vector3.Zero(), scene);
                camera.attachControl(canvas, true);

                // Light setup
                const light = new BABYLON.HemisphericLight("light", new BABYLON.Vector3(0, 5, 3), scene);
                light.intensity = 2;

                scene.clearColor = new BABYLON.Color4(0.1, 0.1, 0.1, 1); // Dark Satin Gray

                // Load default 3D model (assuming it's a glb file)
                BABYLON.SceneLoader.ImportMesh("", "./static/", "DefaultModel.glb", scene, function (newMeshes) {
                    currentModel = newMeshes[0];
                    // Adjust the scale and position as needed
                    currentModel.scaling = new BABYLON.Vector3(17, 17, 17);
                    currentModel.position = new BABYLON.Vector3(-1, -4, 0.5);
                }, undefined, function (scene, message, exception) {
                    console.error("Error loading default 3D model:", message, exception);
                });

                // Enable drag and drop for 3D models
                canvas.addEventListener("dragover", function (event) {
                    event.preventDefault();
                });

                canvas.addEventListener("drop", function (event) {
                    event.preventDefault();
                    const file = event.dataTransfer.files[0];
                    if (file) {
                        loadModel(file);
                    }
                });

                // Enable click to manipulate
                canvas.addEventListener("click", function (event) {
                    if (!engine.isPointerLock) {
                        const pickResult = scene.pick(scene.pointerX, scene.pointerY);
                        if (pickResult.hit) {
                            // Toggle pointer lock on click
                            canvas.requestPointerLock = canvas.requestPointerLock || canvas.mozRequestPointerLock || canvas.webkitRequestPointerLock;
                            canvas.requestPointerLock();
                        }
                    }
                });

                return scene;
            } catch (error) {
                console.error("Error creating scene:", error);
            }
        };

        const loadModel = function (file) {
            // Load model logic
            // ...
        };

        // Function to open Ordinals Wallet modal
        const openModal = function () {
            const modal = document.getElementById("ordinalsWalletModal");
            modal.style.display = "block";
        };

        // Function to close Ordinals Wallet modal
        const closeModal = function () {
            const modal = document.getElementById("ordinalsWalletModal");
            modal.style.display = "none";
        };

        // Function to call API
        const callApi = function (apiUrl) {
            // Logic to perform API call
            console.log("Calling API:", apiUrl);
            // Replace with actual API call logic
        };

        // Create the Babylon scene
        createScene();

        // Babylon engine render loop
        if (scene) {
            engine.runRenderLoop(function () {
                scene.render();
            });

            // Handle window resize
            window.addEventListener("resize", function () {
                engine.resize();
            });
        }
    </script>

    <!-- Ordinals Wallet modal content -->
    <div id="ordinalsWalletModal" class="modal" onclick="closeModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2>Ordinals Wallet Functions</h2>
            <button onclick="callApi('https://turbo.ordinalswallet.com/inscription/:inscription_id')">Fetch an Inscription</button>
            <button onclick="callApi('https://turbo.ordinalswallet.com/inscription/:inscription_id/outpoint')">Fetch Inscription Location</button>
            <button onclick="callApi('https://cdn.ordinalswallet.com/inscription/content/:inscription_id')">Fetch Raw Content</button>
            <button onclick="callApi('https://cdn.ordinalswallet.com/inscription/preview/:inscription_id')">Fetch Image Preview</button>
            <button onclick="callApi('https://turbo.ordinalswallet.com/collection/:slug')">Fetch a Collection</button>
            <button onclick="callApi('https://turbo.ordinalswallet.com/collection/:slug/stats')">Fetch Collection Stats</button>
            <button onclick="callApi('https://turbo.ordinalswallet.com/collection/:slug/snapshot')">Fetch Collection Snapshot</button>
            <button onclick="callApi('https://turbo.ordinalswallet.com/wallet/:address')">Wallet Balance</button>
        </div>
    </div>
</body>

</html>
